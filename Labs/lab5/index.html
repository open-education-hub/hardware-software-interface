<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Labs/lab5">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Lab 5 - Introduction to Assembly Language | Hardware Software Interface</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//hardware-software-interface/Labs/lab5"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 5 - Introduction to Assembly Language | Hardware Software Interface"><meta data-rh="true" name="description" content="Task: Conditional jumps"><meta data-rh="true" property="og:description" content="Task: Conditional jumps"><link data-rh="true" rel="canonical" href="http://localhost//hardware-software-interface/Labs/lab5"><link data-rh="true" rel="alternate" href="http://localhost//hardware-software-interface/Labs/lab5" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//hardware-software-interface/Labs/lab5" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/hardware-software-interface/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/hardware-software-interface/assets/js/runtime~main.dfa37bb3.js" as="script">
<link rel="preload" href="/hardware-software-interface/assets/js/main.5804b916.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/hardware-software-interface/"><div class="navbar__logo"><img src="/hardware-software-interface/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/hardware-software-interface/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Hardware Software Interface</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/hardware-software-interface/Labs">Labs</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hardware-software-interface/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/hardware-software-interface/Labs/">Labs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Labs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab1">Lab 1 - Number Representation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab2">Lab 2 - Memory Operations. Introduction to GDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab4">Lab 4 - Toolchain. GOTO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/hardware-software-interface/Labs/lab5">Lab 5 - Introduction to Assembly Language</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab6">Lab 6 - Registers and Memory Addressing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab7">Lab 7 - Structures, Vectors and Strings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab8">Lab 8 - The Stack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab9">Lab 9 - Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab10">Lab 10 - The C - Assembly Interaction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab11">Lab 11 - Buffer Management. Buffer Overflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab12">Lab 12 - Linking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab13">Lab 13 - CTF</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/hardware-software-interface/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/hardware-software-interface/Labs/"><span itemprop="name">Labs</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 5 - Introduction to Assembly Language</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 5 - Introduction to Assembly Language</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-conditional-jumps">Task: Conditional jumps<a class="hash-link" href="#task-conditional-jumps" title="Direct link to heading">​</a></h2><p>You will solve the exercises starting from the <code>hello_world.asm</code> file located in the <code>drills/tasks/conditional-jumps</code> directory.</p><ol><li><p>Modify the program so that the message is displayed only if the content of the <code>eax</code> register is greater than that of <code>ebx</code>.
Also, modify the values of the registers to continue displaying the message <code>&quot;Hello, World!&quot;</code>.</p></li><li><p>Modify the program to also display <code>&quot;Goodbye, World!&quot;</code> at the end.</p></li><li><p>Using jump instructions, modify the program to display <code>&quot;Hello, World!&quot;</code> N times, where N is given through the <code>ecx</code> register.
Avoid infinite looping.</p></li></ol><blockquote><p><strong>TIP</strong>: After successful completion, the program should display:</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Hello</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> World</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> World</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> World</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> World</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> World</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> World</span><span class="token operator" style="color:#393A34">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Goodbye</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> World</span><span class="token operator" style="color:#393A34">!</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab5#x86-family">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-grumpy-jumps">Task: Grumpy Jumps<a class="hash-link" href="#task-grumpy-jumps" title="Direct link to heading">​</a></h2><p>You will solve the exercises starting from the <code>grumpy_jumps.asm</code> file located in the <code>drills/tasks/grumpy-jumps</code> directory.</p><ol><li><p>Modify the values of the <code>eax</code> and <code>ebx</code> registers so that when the program is run, the message <code>Well done!</code> is displayed.
Follow the <code>TODO</code> comments.</p></li><li><p>Why does the wrong message still appear?
Modify the source so that the wrong message is not displayed anymore.</p></li></ol><blockquote><p><strong>TIP</strong>: To determine the necessary values for the <code>eax</code> and <code>ebx</code> registers, we recommend using GDB.</p></blockquote><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab5#x86-family">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-sets">Task: Sets<a class="hash-link" href="#task-sets" title="Direct link to heading">​</a></h2><p>You will solve the exercises starting from the <code>sets.asm</code> file located in the <code>drills/tasks/sets</code> directory.</p><p>You need to implement operations on sets that can contain elements between 0 and 31.
An efficient way to do this (both in terms of space and speed) would be to represent sets so that a register represents a set.
Each bit in the register represents an element in the set (if bit i is set, then the set contains element i).</p><blockquote><p><strong>TIP</strong>: For example: if <code>eax</code> contains the representation of the set <code>{0,2,4}</code>, the register value would be <code>2^0 + 2^2 + 2^4 = 1 + 4 + 16 = 21</code>.
Educate yourself about the available instructions on the <a href="/hardware-software-interface/Labs/guides/x86.html">x86 architecture</a>.</p></blockquote><ul><li><p>You have two defined sets.
What values do they contain?
Perform the union of the two sets.</p></li><li><p>Use the <code>or</code> instruction to add two new elements to the set.</p></li></ul><blockquote><p><strong>TIP</strong>: Take advantage of the fact that the current sets, although they have &quot;space&quot; for 32 bits, only use 8 bits.
If you <code>or</code> with a number greater than 255 (<code>0xff</code>, <code>2^8-1</code>) which has two active bits, you will effectively add two new elements to the set.</p></blockquote><ul><li><p>Perform the intersection of the two sets.</p></li><li><p>Determine the elements missing from the <code>eax</code> set for it to be complete.</p></li></ul><blockquote><p><strong>TIP</strong>: You need to take the complement of the number using the <code>not</code> instruction.</p></blockquote><ul><li><p>Remove an element from the first set.</p></li><li><p>Find the difference between the sets.</p></li></ul><blockquote><p><strong>NOTE</strong>: In order to display the answer, you can use the <code>PRINTF32</code> macro.
For example:</p><div class="language-assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PRINTF32 `The union is: \x0`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PRINTF32 `%u\n\x0`, `EAX`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab5#x86-family">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-min">Task: Min<a class="hash-link" href="#task-min" title="Direct link to heading">​</a></h2><p>You will solve this exercise starting from the <code>min.asm</code> file located in the <code>drills/tasks/min</code> directory.</p><p>Calculate the minimum of the numbers in 2 registers (<code>eax</code> and <code>ebx</code>) using a comparison instruction, a jump instruction, and the <code>xchg</code> instruction.</p><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab5#x86-family">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-fibonacci">Task: Fibonacci<a class="hash-link" href="#task-fibonacci" title="Direct link to heading">​</a></h2><p>You will solve this exercise starting from the <code>fibonacci.asm</code> file located in the <code>drills/tasks/fibonacci</code> directory.</p><p>Calculate the Nth Fibonacci number, where N is given through the <code>eax</code> register.</p><blockquote><p><strong>NOTE</strong>: The fibonacci series goes as follows : <code>0, 1, 1, 2, 3, ...</code> where each element <code>f[i] = f[i-2] + f[i-1]</code>, except for the first two elements.</p><p><strong>TIP</strong>: For example, if the value stored in <code>eax</code> is equal to <code>5</code>, a correct solution will display <code>3</code> and for <code>7</code>, it will display <code>8</code>.</p></blockquote><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab5#x86-family">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-carry-flag---overflow-flag">Task: Carry Flag - Overflow Flag<a class="hash-link" href="#task-carry-flag---overflow-flag" title="Direct link to heading">​</a></h2><p>You will solve this exercises starting from the <code>of.asm</code>, <code>cf.asm</code> and <code>cf_of.asm</code> files located in the <code>drills/tasks/cf-of</code> directory.</p><p>Using the <code>add</code> instruction on the <code>al</code> register:</p><ol><li><p>Set the <code>OF</code> flag</p></li><li><p>Set the <code>CF</code> flag</p></li><li><p>Set both flags simultaneously.</p></li></ol><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab5#x86-family">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>Before we actually start learning to read code written in assembly language, and then write our first programs, we need to answer a few questions.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-assembly-language">What is the Assembly Language?<a class="hash-link" href="#what-is-the-assembly-language" title="Direct link to heading">​</a></h3><p>As you probably know, the basic role of a computer - specifically, of the processor - is to read, interpret, and execute instructions.
These instructions are encoded in machine code.</p><p>An example would be:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1011000000001100011001100011000111011111111111100100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This sequence of bits doesn&#x27;t tell us much in particular.
We can convert it to hexadecimal to compress it and group it better.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">\xB0\x0C\x66\x31\xD2\xFF\xE4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Furthermore, for many of us, this sequence still doesn&#x27;t mean anything.
Hence the need for a more understandable and usable language.</p><p>Assembly language allows us to write text programs which will then be translated, through an utility called an <strong>assembler</strong>, specific to each architecture, into machine code.
Most assembly languages provide a direct correspondence between instructions. For example:</p><div class="language-assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov al, 12 &lt;-&gt; &#x27;\xB0\x0C&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">xor dx, dx &lt;-&gt; &#x27;\x67\x31\xD2&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jmp esp    &lt;-&gt; &#x27;\xFF\xE4&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>NOTE</strong>: Because assembly language depends on architecture, it is generally not portable.
Therefore, processor manufacturers have tried to keep the instructions unchanged from one generation to another, so that even when adding new processors to the line-up, they would maintain compatibility within the same processor family (for example, Intel processors 80286, 80386, 80486 etc. are all part of the generic Intel x86).</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-learn-assembly-language">Why Learn Assembly Language?<a class="hash-link" href="#why-learn-assembly-language" title="Direct link to heading">​</a></h3><p>Besides the very high didactic value, in which you understand what &quot;stack overflow&quot; consists of, data representation, and what is specific to the processor you are working with, there are a few applications where knowledge of assembly language and, implicitly, architecture are necessary or even critical.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="debugging">Debugging<a class="hash-link" href="#debugging" title="Direct link to heading">​</a></h4><p>It&#x27;s quite likely that at least one of the programs you&#x27;ve written in the past generated the following result:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Segmentation fault</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Sometimes, you will encounter a series of data similar to the following:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Page Fault cr2=10000000 at eip e75; flags=6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eax=00000030 ebx=00000000 ecx=0000000c edx=00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">esi=0001a44a edi=00000000 ebp=00000000 esp=00002672</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cs=18 ds=38 es=af fs=0 gs=0 ss=20 error=0002</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For someone who knows assembly language, it&#x27;s relatively easy to begin troubleshooting using a debugger like <a href="http://www.gnu.org/software/gdb/" target="_blank" rel="noopener noreferrer">GDB</a> or <a href="http://www.ollydbg.de/" target="_blank" rel="noopener noreferrer">OllyDbg</a>, because the message provides almost all the information they need.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="code-optimization">Code Optimization<a class="hash-link" href="#code-optimization" title="Direct link to heading">​</a></h4><p>Think about how you would write a C program to perform AES encryption and decryption.
Then, inform the compiler that you want to optimize your code.
Evaluate the performance of that code (size, execution time, number of jump instructions, etc.).
Although compilers are often labeled as &quot;black magic&quot;, there are situations where you simply know <a href="https://www.intel.com/content/dam/doc/white-paper/advanced-encryption-standard-new-instructions-set-paper.pdf" target="_blank" rel="noopener noreferrer">something</a> about the processor you&#x27;re working with better than they do.</p><p>Furthermore, just understanding assembly code is enough to evaluate a code and optimize its critical sections.
Even if you don&#x27;t write code in assembly language, you&#x27;ll be aware of the code generated from the C instructions you use.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="reverse-engineering">Reverse Engineering<a class="hash-link" href="#reverse-engineering" title="Direct link to heading">​</a></h4><p>A large portion of common applications are closed-source.
All you have when it comes to these applications is a pre-compiled binary file.
Some of these may contain malicious code, in which case they need to be analyzed in a controlled environment (malware analysis/research).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="embedded-and-others">Embedded and Others<a class="hash-link" href="#embedded-and-others" title="Direct link to heading">​</a></h4><p>There are cases where constraints on code and/or data size are imposed, such as specialized devices for a single task, with little memory.
This category includes drivers for devices.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="fun">Fun<a class="hash-link" href="#fun" title="Direct link to heading">​</a></h4><p>For more details, discuss with your laboratory assistant to share his personal experience with assembly language and practical use cases.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="x86-family">x86 Family<a class="hash-link" href="#x86-family" title="Direct link to heading">​</a></h2><p>Almost all major processors from Intel share a common ISA (Instruction Set Architecture).
These processors are highly backward compatible, with most instructions unchanged over generations, but only added or extended.</p><blockquote><p><strong>NOTE</strong>: An ISA defines the instructions supported by a processor, register size, addressing modes, data types, instruction format, interrupts, and memory organization.
Processors in this family fall into the broad category of CISC (Complex Instruction Set Computers).
The philosophy behind them is to have a large number of instructions, with variable length, capable of performing complex operations, over multiple clock cycles.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="registers">Registers<a class="hash-link" href="#registers" title="Direct link to heading">​</a></h3><p>The basic working units for x86 processors are registers.
These are a suite of locations within the processor through which it interacts with memory, I/O, etc.</p><p>x86 processors have 8 such 32-bit registers.
Although any of these can be used in operations, for historical reasons, each register has a specific role.</p><table><thead><tr><th>Name</th><th>Role</th></tr></thead><tbody><tr><td><code>eax</code></td><td>accumulator; system calls, I/O, arithmetic</td></tr><tr><td><code>ebx</code></td><td>base register; used for memory-based addressing</td></tr><tr><td><code>ecx</code></td><td>counter in loop instructions</td></tr><tr><td><code>edx</code></td><td>data register, used for I/O, arithmetic, interrupt values; can extend eax to 64 bits</td></tr><tr><td><code>esi</code></td><td>source in string operations</td></tr><tr><td><code>edi</code></td><td>destination in string operations</td></tr><tr><td><code>ebp</code></td><td>base or frame pointer; points to the current stack frame</td></tr><tr><td><code>esp</code></td><td>stack pointer; points to the top of the stack</td></tr></tbody></table><p>In addition to these, there are some special registers that cannot be directly accessed by the programmer, such as <code>eflags</code> and <code>eip</code> (Instruction Pointer).</p><p><code>eip</code> is a register that holds the address of the current instruction to be executed.
It cannot be directly modified, programmatically, but indirectly through jump, call, and ret instructions.</p><p>The <code>eflags</code> register contains <code>32</code> bits used as status indicators or condition variables.
We say that a flag is set if its value is <code>1</code>. The ones commonly used by programmers are:</p><table><thead><tr><th>Name</th><th>Expanded Name</th><th>Description</th></tr></thead><tbody><tr><td><code>CF</code></td><td>Carry Flag</td><td>Set if the result exceeds the maximum (or minimum) unsigned integer value</td></tr><tr><td><code>PF</code></td><td>Parity Flag</td><td>Set if the low byte of the result contains an even number of 1 bits</td></tr><tr><td><code>AF</code></td><td>Auxiliary Carry Flag</td><td>Used in BCD arithmetic; set if bit 3 generates a carry or borrow</td></tr><tr><td><code>ZF</code></td><td>Zero Flag</td><td>Set if the result of the previous instruction is 0</td></tr><tr><td><code>SF</code></td><td>Sign Flag</td><td>Has the same value as the sign bit of the result (1 negative, 0 positive)</td></tr><tr><td><code>OF</code></td><td>Overflow Flag</td><td>Set if the result exceeds the maximum (or minimum) signed integer value</td></tr></tbody></table><blockquote><p><strong>NOTE</strong>: If you follow the evolution of registers from 8086, you&#x27;ll see that initially they were named <code>ax</code>, <code>bx</code>, <code>cx</code> etc., and were 16 bits in size.
From 80386, Intel extended these registers to 32 bits (i.e., &quot;extended&quot; <code>ax</code> → <code>eax</code>).</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="instruction-classes">Instruction Classes<a class="hash-link" href="#instruction-classes" title="Direct link to heading">​</a></h3><p>Although the current set of instructions for Intel processors has <a href="https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-instruction-set-reference-manual-325383.pdf" target="_blank" rel="noopener noreferrer">hundreds of instructions</a>, we will only look at a <a href="http://css.csail.mit.edu/6.858/2015/readings/i386.pdf" target="_blank" rel="noopener noreferrer">small portion of them</a>.
More precisely, some of the 80386 instructions.</p><p>All x86 processors instructions can fit into 3 categories :</p><ul><li>data movement instructions</li><li>arithmetical/logical instructions</li><li>program control instructions</li></ul><p>We will only display some of the more important instructions of each category since many of them are alike.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="data-movement-instructions">Data Movement Instructions<a class="hash-link" href="#data-movement-instructions" title="Direct link to heading">​</a></h4><p>These instructions are used to transfer data between registers, between memory and registers, and to initialize data:</p><table><thead><tr><th>Name</th><th>Operands</th><th>Description</th></tr></thead><tbody><tr><td><code>mov</code></td><td><code>dst, src</code></td><td>Moves the value from source to the destination(erasing what was in the destination before)</td></tr><tr><td><code>push</code></td><td><code>src</code></td><td>Moves the value from the source onto the &quot;top&quot; of the stack</td></tr><tr><td><code>pop</code></td><td><code>dst</code></td><td>Moves the value from the &quot;top&quot; of the stack into the destination</td></tr><tr><td><code>lea</code></td><td><code>dst, src</code></td><td>Loads the effective address of the source to the destination</td></tr><tr><td><code>xchg</code></td><td><code>dst, src</code></td><td>Swaps (Exchanges) the values between the source and the destination</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="arithmetic-and-logic-instructions">Arithmetic and Logic Instructions<a class="hash-link" href="#arithmetic-and-logic-instructions" title="Direct link to heading">​</a></h4><p>These instructions perform arithmetic and logic operations:</p><table><thead><tr><th>Name</th><th>Operands</th><th>Description</th></tr></thead><tbody><tr><td><code>add</code></td><td><code>dst, src</code></td><td>Adds the source and the destination, storing the result in the destination</td></tr><tr><td><code>sub</code></td><td><code>dst, src</code></td><td>Subtracts the source from the destination, storing the result in the destination</td></tr><tr><td><code>and</code></td><td><code>dst, src</code></td><td>Calculates logical AND between the source and the destination, storing the result in the destination</td></tr><tr><td><code>or</code></td><td><code>dst, src</code></td><td>Calculates logical OR between the source and the destination, storing the result in the destination</td></tr><tr><td><code>xor</code></td><td><code>dst, src</code></td><td>Calculates logical XOR between the source and the destination, storing the result in the destination</td></tr><tr><td><code>test</code></td><td><code>dst, src</code></td><td>Calculates logical AND between the source and the destination without storing the result</td></tr><tr><td><code>shl</code></td><td><code>dst, &lt;const&gt;</code></td><td>Calculates the logical shifted value from the destination with a constant number of positions, storing the result in the destination</td></tr></tbody></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="program-control-instructions">Program Control Instructions<a class="hash-link" href="#program-control-instructions" title="Direct link to heading">​</a></h4><p>These instructions are used to control the flow of programs:</p><table><thead><tr><th>Name</th><th>Operands</th><th>Description</th></tr></thead><tbody><tr><td><code>jmp</code></td><td><code>&lt;address&gt;</code></td><td>Jumps unconditionally to the specified address(directly, by register, by labels)</td></tr><tr><td><code>cmp</code></td><td><code>dst, src</code></td><td>Compares the source with the destination(more details below)</td></tr><tr><td>j<code>cond</code></td><td><code>&lt;address&gt;</code></td><td>Jumps conditionally to the specified address depending on the state of the flag(set/not set)/condition variable</td></tr><tr><td>call</td><td><code>&lt;address&gt;</code></td><td>Calls the subroutine located at the specified address</td></tr></tbody></table><blockquote><p><strong>NOTE</strong>: <a href="https://www.felixcloutier.com/x86/cmp" target="_blank" rel="noopener noreferrer">The &#x27;cmp dest, src&#x27; instruction</a> effectively calculates <code>dest - src</code> behind the scenes(as in subtracting the source from the destination).
We are talking about an unsigned subtraction, without storing the result.</p></blockquote><p>Therefore, when talking about the code:</p><blockquote><div class="language-assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  cmp eax, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jl negative</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p>The jump to the <code>negative</code> label will be made only if the value in eax is less than <code>0</code>.
The <code>eax - 0</code> subtraction is evaluated and if the result is negative(and so, eax is negative), the jump will be made.\
When have comparisons with <code>0</code>, the same thing can be done more efficiently using the <code>test</code> instruction:</p><blockquote><div class="language-assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  test eax, eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  jl negative</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p>More on this <a href="https://en.wikibooks.org/wiki/X86_Assembly/Control_Flow#Comparison_Instructions" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="guide-first-look-at-assembly-instructions">Guide: First look at Assembly instructions<a class="hash-link" href="#guide-first-look-at-assembly-instructions" title="Direct link to heading">​</a></h2><p>To follow this guide, you will need to use the <code>instructions.asm</code> file located in the <code>guides/instructions/support</code> directory.</p><p>Diving right into the demo, we can see one of the most important instructions that helps us, programmers, work with the stack and that is <code>push</code>.
We discussed what the <code>push</code> instruction does in the <a href="/hardware-software-interface/Labs/lab5#x86-family">reading section</a>.
Considering its call, we can understand that it takes the <code>0</code> value(as a <code>DWORD</code>, a number stored on <code>4</code> bytes) and moves it onto the &quot;top&quot; of the stack.</p><p>That <code>push</code> is followed by a new instruction:</p><div class="language-assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">popf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>IMPORTANT</strong>: The <code>popf</code> instruction is used for setting, depending on how many bytes we pop from the stack(in our case, 4 bytes), the <code>EFLAGS</code> register(setting the entire register when popping 4 bytes and only the 2 lower bytes of the register when popping 2 bytes).
You can read more about the <code>popf</code> instruction <a href="https://www.felixcloutier.com/x86/popf:popfd:popfq" target="_blank" rel="noopener noreferrer">here</a> and <a href="https://en.wikipedia.org/wiki/FLAGS_register" target="_blank" rel="noopener noreferrer">here</a>.</p></blockquote><p><img loading="lazy" alt="EFLAGS Representation" src="/hardware-software-interface/assets/images/eflags-representation-2092cff4e0c5323ca3736ef4a4ab22b4.svg" class="img_ev3q"></p><p>Having in mind what the <code>popf</code> instruction does, try to guess what would adding the following line of code at line 15 and the <code>mystery_label</code> label at the line(of the current file, before adding the instruction) 53 would make the program do.</p><div class="language-assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jnc mystery_label</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Moving on, we can see that the <code>0</code> value is set to the <code>eax</code> register using the <code>mov</code> instruction.
Can you give example of another two ways of setting the value in <code>eax</code> to <code>0</code> without using <code>mov</code> ?</p><blockquote><p><strong>HINT</strong>: Think about the <a href="/hardware-software-interface/Labs/lab5#x86-family">logical operators</a>.</p></blockquote><p>Next, by using the <code>test</code> instruction we can set the <code>flags</code> based on the output of the <code>logical and</code> between <code>eax</code> and itself.</p><p>After resetting the flags, we store <code>0xffffffff</code> in the <code>ebx</code> register(which is actually the largest number it can store before setting the carry flag) and then use the <code>test</code> instruction yet again.
Similarly, what do you think adding the following line of code after the <code>test</code> instruction would produce ?</p><div class="language-assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">jnz mystery_label</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We reset the flags once again and now we take a look at working with the smaller portions of the <code>eax</code> register.
Can you guess the output of the following command, put right under the <code>add al, bl</code> instruction ?
What about the flags ?
Which flag has been set ?</p><div class="language-assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PRINTF32 `%d\n\x0`, eax</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Similarly, try to answer the same questions from above, but considering the next portions of the code.</p><p>After thoroughly inspecting this example, you should have a vague idea about how setting the flags works.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="guide-discovering-assembly">Guide: Discovering Assembly<a class="hash-link" href="#guide-discovering-assembly" title="Direct link to heading">​</a></h2><p>To follow this guide, you will need to navigate to the <code>guides/discovering-assembly/support</code> directory.</p><ol><li><p>Open the <code>ex1.asm</code> file and read the comments.
Assemble it by using the <code>make</code> utility and run it.
Using gdb, go through the program line by line (the <code>start</code> command followed by <code>next</code>) and observe the changes in register values after executing the <code>mov</code> and <code>add</code> instructions.
Ignore the sequence of <code>PRINTF32</code> instructions.</p></li><li><p>Open the <code>ex2.asm</code> file and read the comments.
Assemble it by using the <code>make</code> utility and run it.
Using gdb, observe the change in the <code>eip</code> register when executing the <code>jmp</code> instruction.
To skip the <code>PRINTF32</code> instructions, add a breakpoint at the <code>jump_incoming</code> label (the <code>break</code> command followed by <code>run</code>).</p></li><li><p>Open the <code>ex3.asm</code> file and read the comments.
Assemble it by using the <code>make</code> utility and run it.
Using gdb, navigate through the program using breakpoints.
Follow the program flow.
Why is <code>15</code> displayed first and then <code>3</code>?
Because of the jump at line 9.
Where does the jump at line 25 point to?
To the <code>zone1</code> label.</p></li><li><p>Open the <code>ex4.asm</code> file and read the comments.
Assemble it by using the <code>make</code> utility and run it.
Using gdb, go through the program.
Why isn&#x27;t the jump at line 12 taken?
Because the <code>je</code> instruction jumps if the <code>ZF</code> bit in the <code>FLAGS</code> register is set.
This bit is set by the <code>cmp</code> instruction, which calculates the difference between the values of the <code>eax</code> and <code>ebx</code> registers without storing the result.
However, the <code>add</code> instruction at line 11 clears this flag because the result of the operation is different from 0.</p></li></ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/hardware-software-interface/Labs/lab4"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 4 - Toolchain. GOTO</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/hardware-software-interface/Labs/lab6"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 6 - Registers and Memory Addressing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-conditional-jumps" class="table-of-contents__link toc-highlight">Task: Conditional jumps</a></li><li><a href="#task-grumpy-jumps" class="table-of-contents__link toc-highlight">Task: Grumpy Jumps</a></li><li><a href="#task-sets" class="table-of-contents__link toc-highlight">Task: Sets</a></li><li><a href="#task-min" class="table-of-contents__link toc-highlight">Task: Min</a></li><li><a href="#task-fibonacci" class="table-of-contents__link toc-highlight">Task: Fibonacci</a></li><li><a href="#task-carry-flag---overflow-flag" class="table-of-contents__link toc-highlight">Task: Carry Flag - Overflow Flag</a></li><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a><ul><li><a href="#what-is-the-assembly-language" class="table-of-contents__link toc-highlight">What is the Assembly Language?</a></li><li><a href="#why-learn-assembly-language" class="table-of-contents__link toc-highlight">Why Learn Assembly Language?</a></li></ul></li><li><a href="#x86-family" class="table-of-contents__link toc-highlight">x86 Family</a><ul><li><a href="#registers" class="table-of-contents__link toc-highlight">Registers</a></li><li><a href="#instruction-classes" class="table-of-contents__link toc-highlight">Instruction Classes</a></li></ul></li><li><a href="#guide-first-look-at-assembly-instructions" class="table-of-contents__link toc-highlight">Guide: First look at Assembly instructions</a></li><li><a href="#guide-discovering-assembly" class="table-of-contents__link toc-highlight">Guide: Discovering Assembly</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://curs.upb.ro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ocw.cs.pub.ro/courses/pclp2" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/10c1a" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 OpenEdu Team</div></div></div></footer></div>
<script src="/hardware-software-interface/assets/js/runtime~main.dfa37bb3.js"></script>
<script src="/hardware-software-interface/assets/js/main.5804b916.js"></script>
</body>
</html>