<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Labs/lab11">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Lab 11 - Buffer Management. Buffer Overflow | Hardware Software Interface</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//hardware-software-interface/Labs/lab11"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lab 11 - Buffer Management. Buffer Overflow | Hardware Software Interface"><meta data-rh="true" name="description" content="Task: Buffer in the .data Section"><meta data-rh="true" property="og:description" content="Task: Buffer in the .data Section"><link data-rh="true" rel="canonical" href="http://localhost//hardware-software-interface/Labs/lab11"><link data-rh="true" rel="alternate" href="http://localhost//hardware-software-interface/Labs/lab11" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//hardware-software-interface/Labs/lab11" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/hardware-software-interface/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/hardware-software-interface/assets/js/runtime~main.dfa37bb3.js" as="script">
<link rel="preload" href="/hardware-software-interface/assets/js/main.5804b916.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/hardware-software-interface/"><div class="navbar__logo"><img src="/hardware-software-interface/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/hardware-software-interface/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Hardware Software Interface</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/hardware-software-interface/Labs">Labs</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/hardware-software-interface/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/hardware-software-interface/Labs/">Labs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Labs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab1">Lab 1 - Number Representation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab2">Lab 2 - Memory Operations. Introduction to GDB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab4">Lab 4 - Toolchain. GOTO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab5">Lab 5 - Introduction to Assembly Language</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab6">Lab 6 - Registers and Memory Addressing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab7">Lab 7 - Structures, Vectors and Strings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab8">Lab 8 - The Stack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab9">Lab 9 - Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab10">Lab 10 - The C - Assembly Interaction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/hardware-software-interface/Labs/lab11">Lab 11 - Buffer Management. Buffer Overflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab12">Lab 12 - Linking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hardware-software-interface/Labs/lab13">Lab 13 - CTF</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/hardware-software-interface/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/hardware-software-interface/Labs/"><span itemprop="name">Labs</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Lab 11 - Buffer Management. Buffer Overflow</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Lab 11 - Buffer Management. Buffer Overflow</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-buffer-in-the-data-section">Task: Buffer in the <code>.data</code> Section<a class="hash-link" href="#task-buffer-in-the-data-section" title="Direct link to heading">​</a></h2><p>Navigate to the <code>drills/tasks/data-buffer/support/</code> directory in the laboratory&#x27;s resource archive and open the <code>data_buffer.asm</code> file.
This file contains a program that populates a buffer with information and then displays it.</p><p>Carefully review the program, then compile it using the command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">make</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notice that after running the above compilation command, both an object file and an executable file are generated. You can verify this by running the command:</p><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Run the program using the executable file, using the command:</p><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./data_buffer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Observe the behavior of the program based on its code.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-buffer-on-the-stack">Task: Buffer on the Stack<a class="hash-link" href="#task-buffer-on-the-stack" title="Direct link to heading">​</a></h2><p>Access the <code>drills/tasks/stack-buffer/support/</code> directory from the lab resource archive and consult the <code>stack_buffer.asm</code> file.
This file contains a program that populates a buffer with information and then displays it.
It is similar to the one above, but now the buffer is allocated on the stack.</p><p>The task will contain 3 parts.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-1">Part 1<a class="hash-link" href="#part-1" title="Direct link to heading">​</a></h3><p>Carefully review the program, then compile it using the command:</p><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>then run it using the command:</p><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./stack_buffer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Observe the behavior of the program according to its code.</p><p>In addition to the buffer, we have also allocated a local variable of 4 bytes, accessible at the address <code>ebp - 4</code>.
It is initialized to the value <code>0xCAFEBABE</code>.
This variable will be important later on.
What is relevant now is to know that this variable is in memory <strong>immediately after the buffer</strong>: when the buffer limit is exceeded, you reach this variable.</p><p>What is the difference between the two programs inspected so far?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-2">Part 2<a class="hash-link" href="#part-2" title="Direct link to heading">​</a></h3><p>Now that we have seen what the buffer looks like in memory and where the variable is placed,
update the <code>stack_buffer.asm</code> program so that the buffer display sequence
(Look for <strong>TODO 1</strong>) also leads to the display of the variable&#x27;s bytes.
It is a case of read buffer overflow, with the objective of <strong>information leak</strong>: finding out information from memory.</p><blockquote><p><strong>HINT</strong> It&#x27;s not complicated, you just need to &quot;instruct&quot; the display sequence to use a different limit for display,
not the current limit of 64 bytes.</p></blockquote><p>Follow <strong>TODO 2</strong> and display other information beyond the local variable.
What information comes on the stack after the local variable (the next 4 bytes)?
And the next 4 bytes after?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="part-3">Part 3<a class="hash-link" href="#part-3" title="Direct link to heading">​</a></h3><p>Based on the experience above, make changes so that the variable&#x27;s value is <code>0xDEADBEEF</code>
(instead of <code>0xCAFEBABE</code> as it is initially) without, however, explicitly modifying the variable&#x27;s value.
Look for <strong>TODO 3</strong> and use the buffer modification and the <code>ebx</code> register in which we stored the start address of the buffer.</p><blockquote><p><strong>TIP</strong> Again, it&#x27;s not complicated.
You need to use the <code>ebx</code> value and an offset to write the <code>0xDEADBEEF</code> value at that address.
That is, use a construction like:</p></blockquote><div class="language-Assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mov byte [ebx + TODO], TODO</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>Do this after the buffer initialization sequence (after the <code>jl fill_byte</code> instruction).</p></blockquote><p>With a correct solution to this exercise, the program will display the <code>0xDEADBEEF</code> value for the local variable.</p><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab11#introduction-to-buffers">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-reading-data-from-standard-input">Task: Reading Data from Standard Input<a class="hash-link" href="#task-reading-data-from-standard-input" title="Direct link to heading">​</a></h2><p>Access the <code>drills/tasks/read-stdin-gets/support/</code> directory from the lab resource archive and consult the <code>read_stdin.asm</code> file.
In this file, there is a program that uses the <code>gets</code> call to read information from standard input into a buffer on the stack.
As in the previous case, we have allocated a local variable of 4 bytes immediately after the stack buffer.</p><p>Carefully review the program, then compile it using the command:</p><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>then run it using the command:</p><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./read_stdin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Observe the behavior of the program depending on the received input.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="buffer-overflow-with-data-from-standard-input">Buffer Overflow with Data from Standard Input<a class="hash-link" href="#buffer-overflow-with-data-from-standard-input" title="Direct link to heading">​</a></h3><p>The <a href="https://man7.org/linux/man-pages/man3/gets.3.html" target="_blank" rel="noopener noreferrer">gets</a> function is practically prohibited in C programs because of its high vulnerability:
it does not check the limits of the buffer where the reading is done, and can easily be used for buffer overflow.</p><p>For this, transmit the corresponding input string so that the displayed value for the local variable is not <code>0xCAFEBABE</code>, but <code>0x574F4C46</code> (the ASCII hexadecimal values for <code>FLOW</code>).</p><blockquote><p><strong>IMPORTANT</strong> Do not modify the assembly language code.
Transmit the input string in the appropriate format to the standard input to generate a buffer overflow and to obtain the required result.
<strong>WARNING</strong> Do not write the string <code>&quot;574F4C46&quot;</code>.
This is a string that occupies <code>8</code> bytes.
You must write the ASCII representation of the number <code>0x574F4C46</code>, which is <code>FLOW</code>:
<code>0x57</code> is <code>W</code>, <code>0x4F</code> is <code>O</code>, <code>0x4C</code> is <code>L</code>, and <code>0x46</code> is <code>F</code>.
<strong>HINT</strong> x86 is a <strong>little endian</strong> architecture.
That means the string <code>&quot;FLOW&quot;</code>, having the character-ASCII code correspondence. If it seems unclear, check out this <a href="https://www.geeksforgeeks.org/little-and-big-endian-mystery/" target="_blank" rel="noopener noreferrer">link</a>
<code>F</code>: <code>0x46</code>, <code>L</code>: <code>0x4C</code>, <code>O</code>: <code>0x4F</code>, <code>W</code>: <code>0x57</code> will be stored in memory on <code>4</code> bytes as <code>0x574F4C46</code>.
So at the bigger address we will have <code>W</code>, while at the lower address there will be <code>F</code>.
<strong>HINT</strong> To transmit the input string, it is recommended to write it in a file and then redirect that file to the corresponding program command.
You can use an editor such as <code>gedit</code> or <code>vim</code> to edit the file.
The advantage is that they also display the column you are on, and you can know how many characters you have written in the file.
Alternatively, you can use python to more easily generate your payload.
For example, to generate a payload that overwrites a value in the code with the value <code>0xDEADBEEF</code>, you can execute the following command:</p></blockquote><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">c </span><span class="token string" style="color:#e3116c">&#x27;print &quot;A&quot; * 32 + &quot;\xEF\xBE\xAD\xDE&quot;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> payload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>NOTE</strong> number <code>32</code> is only an example and it represents the size of buffer that needs to be bypassed.
It is recommended to name the file <code>payload</code>. Redirecting the <code>payload</code> file to the program is done using a command like:</p></blockquote><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./read_stdin &lt; payload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If done correctly, you will see:</p><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var is 0x574F4C46</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab11#introduction-to-buffers">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-buffer-overflow-with-data-from-standard-input-and-fgets">Task: Buffer Overflow with Data from Standard Input and <code>fgets()</code><a class="hash-link" href="#task-buffer-overflow-with-data-from-standard-input-and-fgets" title="Direct link to heading">​</a></h2><p>As mentioned in the <a href="/hardware-software-interface/Labs/lab11#task-reading-data-from-standard-input"><strong>Read Using gets</strong> task</a>, the <code>gets()</code> function is prohibited in current programs.
Instead, the <code>fgets()</code> function can be used.
Open the source code file <code>read_stdin_fgets.asm</code> from the <code>drills/tasks/read-stdin-fgets/support/</code>.
In the <code>read_stdin_fgets.asm</code> source file, follow <strong>TODO 1</strong> and change the <code>gets()</code> function call to the <code>fgets()</code> function call.</p><p>For the <code>fgets()</code> call, read from standard input.
As an argument for the third parameter of <code>fgets()</code> (of type <code>FILE *</code>) you will use standard input.
To specify standard input, use the <code>stdin</code> stream.
You will need to mark it as external using, at the beginning of the assembly language file, the construction:</p><blockquote><div class="language-Assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">extern stdin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p><code>stdin</code> is an address; to call <code>fgets()</code> with standard input,
it is sufficient to pass on the stack the value from the <code>stdin</code> address, i.e., using the construction:</p><div class="language-Assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">push dword [stdin]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>HINT</strong> Follow the manual page of the <a href="https://man7.org/linux/man-pages/man3/fgets.3.html" target="_blank" rel="noopener noreferrer"><code>fgets()</code></a> function to find out what parameters it receives.
<strong>TIP</strong> Since the <code>fgets()</code> function has 3 parameters (which occupy <code>3 × 4 = 12</code> bytes) you will need to use <code>add esp, 12</code> after the function call,
in restoring the stack, instead of <code>add esp, 4</code> as in the case of the program above that used <code>gets()</code>.
<strong>IMPORTANT</strong> Do not modify the assembly language code. Transmit the input string in the appropriate format to the standard input
to generate a buffer overflow and to obtain the required result.</p></blockquote><p>Follow <strong>TODO 2</strong> in code and call <em>fgets()</em> instead of gets, but keep in mind that you will have to push a value big enough for the buffer size in order to produce an overflow.
The result should be the same like in the <em>read_stdin_gets</em> task.</p><blockquote><p><strong>TIP</strong> As above, to transmit the input string for the program, it is recommended to write it in a file
and then redirect that file to the corresponding program command.
Redirecting the <code>payload</code> file to the program is done using a command like:</p></blockquote><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./read_stdin_fgets &lt; payload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>What happens if you push <em>buffer_length - 1</em>, instead of <em>buffer_length</em>.
Why <em>var is 0x004F4C46</em> now?</p><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab11#introduction-to-buffers">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-buffer-overflow-for-program-written-in-c">Task: Buffer Overflow for Program Written in C<a class="hash-link" href="#task-buffer-overflow-for-program-written-in-c" title="Direct link to heading">​</a></h2><p>Most often, we will identify buffer overflow vulnerabilities in programs written in C.
There we need to see what buffers are and what is the distance from the buffer to the desired variable to be able to overwrite it.</p><blockquote><p><strong>IMPORTANT</strong> It is important to consider that the distance between a buffer and another variable in C may not correspond to the &quot;real-world&quot; distance;
the compiler can make updates, reorders, may leave free spaces between variables, etc.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="overwrite-variable-using-a-buffer">Overwrite Variable Using a Buffer<a class="hash-link" href="#overwrite-variable-using-a-buffer" title="Direct link to heading">​</a></h3><p>For the current exercise, access the <code>drills/tasks/overflow-in-c/support/</code> directory from the lab resource archive and observe the corresponding C source code.
For the case where you do not want to compile the code yourself, you have in the archive the equivalent assembly language file and the executable file.</p><p>Discover the difference between the buffer&#x27;s address and the variable&#x27;s address, create an input file (also called <code>payload</code>) with which to trigger the overflow and make it so that the message <em>Full of win</em> is displayed.</p><p>It is recommended to first take a look at the assembly file, then understand the offsets.</p><blockquote><p><strong>HINT</strong> To see the &quot;real-world&quot; reality, i.e., to find out what the difference is between the buffer and the variable we want to overwrite,
consult the equivalent assembly language file (<code>do_overflow.asm</code>), obtained by assembling the C code.
In this file, you can find the relative address of the buffer to <code>ebp</code> and the variable to <code>ebp</code>;
follow the sequence between lines <code>36</code> and <code>47</code>;
you have a mapping between the variable name and the relative offset to <code>ebp</code>.
With this information, you can create the string to transmit as a payload to the standard input of the program.
<strong>NOTE</strong> If you want to recompile the files run:</p></blockquote><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make clean &amp;&amp; make</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>HINT</strong> As above, to transmit the input string for the program, it is recommended to write it in a file
and then redirect that file to the corresponding program command.
Redirecting the payload file to the program is done using a command like:</p></blockquote><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./do_overflow &lt; payload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>HINT</strong> If you are confused about the value in the C code:</p></blockquote><div class="language-C codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-C codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if (sexy_var == 0x5541494D)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>You can use this <a href="https://www.rapidtables.com/convert/number/hex-to-ascii.html" target="_blank" rel="noopener noreferrer">site</a> to convert from hexadecimal to ASCII.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bonus-stack-canary">BONUS: Stack Canary<a class="hash-link" href="#bonus-stack-canary" title="Direct link to heading">​</a></h3><p>Now that you displayed <em>Full of win!</em>, let&#x27;s take a look at the Makefile</p><blockquote><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat Makefile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></blockquote><p>Carefully analyze the compilation options.
What do you notice?</p><p>As observed above, despite exceeding the buffer size and overwriting another variable in the program, it terminated normally.
This is undesirable when working with buffers because they are a potential source of easy attacks.
Use <code>objdump</code> to inspect the <code>main</code> function of the executable.</p><blockquote><p><strong>HINT</strong> To inspect the source, use the following command:</p></blockquote><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">objdump -M intel -d do_overflow</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, go into the <code>Makefile</code> and modify the <code>CFLAGS</code> parameters by replacing <code>-fno-stack-protector</code> with <code>-fstack-protector</code>.
Recompile the program and run it.
What do you observe?</p><blockquote><p><strong>NOTE</strong> With the <code>-fstack-protector</code> option or flag, we instructed the compiler to enable <em>Stack Smashing Protection</em> for our executable.
Therefore, any buffer overflow attack will be detected in the code, and the program execution will terminate with an error.</p></blockquote><p>Inspect the recompiled executable again with the new flag using <code>objdump</code>.
What has changed?</p><blockquote><p><strong>NOTE</strong> The compiler introduced a randomly generated value called a <strong>canary</strong> onto the stack, which it checks before exiting the current function&#x27;s execution.
Through buffer overflow, this canary was overwritten upon exceeding the buffer&#x27;s size, resulting in a mismatch between the initial canary value and the one at the end of the function execution.</p></blockquote><p>Recompile the files and run:</p><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">make clean &amp;&amp; make</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you try the same payload, it will not work because of the <strong>canary</strong> generated. You will most likely see a message like this:</p><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Not quite there. Try again!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** stack smashing detected ***: terminated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Aborted (core dumped)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab11#buffer-overflow-attacks">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-overwrite-return-address">Task: Overwrite Return Address<a class="hash-link" href="#task-overwrite-return-address" title="Direct link to heading">​</a></h2><p>In the previous exercise, we observed how values of variables stored on the stack can be overwritten.
Recalling how function calls are made <strong>Laboratory 9</strong>, the return address from a function <code>callee</code> back to the <code>caller</code> function is also saved on the stack.</p><p>Exploiting this behavior and starting from the resources in the <code>drills/tasks/overwrite-ret-addr/support/</code> directory, use a buffer overflow to call the <code>void magic_function()</code> by overwriting the return address in the <code>read_buffer()</code> function.</p><blockquote><p><strong>IMPORTANT</strong> The <code>void magic_function()</code> calls the <code>cowsay</code> utility, which you need to install with the following command:</p></blockquote><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install cowsay</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>HINT</strong> To inspect the source, use the following command:</p></blockquote><div class="language-Bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">objdump -M intel -d break_this</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong>HINT</strong> In the <code>read_buffer()</code> function, both the size of the input string and the string itself are read from the keyboard.
Although the buffer is defined as <code>char buffer[64]</code>, using the value <code>n</code> in the <code>fgets(buffer, n, stdin)</code> call allows for a buffer overflow.
Also, <code>fgets()</code> will read a maximum of <code>n - 1</code> characters;
<code>n</code> can be set to a value larger than the actual length of the input string.</p></blockquote><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab11#buffer-overflow-attacks">this</a> reading material.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="task-buffer-overflow-for-binary">Task: Buffer Overflow for Binary<a class="hash-link" href="#task-buffer-overflow-for-binary" title="Direct link to heading">​</a></h2><p>Often, we don&#x27;t have access to source code and want to discover vulnerabilities in executable files.
In the <code>drills/tasks/overflow-for-binary/support/</code> directory of the laboratory resource archive, you will find an executable file.
Using <code>ghidra</code> or <code>gdb</code> for investigation, discover how to exploit the buffer overflow vulnerability to make the program display the message <strong>Great success</strong>.</p><blockquote><p><strong>IMPORTANT</strong> To run <code>ghidra</code> on the <code>overflow_in_binary</code> executable file, you need to create a new project and import the executable file.
Ghidra will automatically detect the file format.
Run the analysis of the executable, then search in the Symbol Tree for the <code>main</code> function.
<strong>HINT</strong> Identify in the disassembled code how input is passed to the program.
Identify where the buffer overflow occurs.
Identify the comparison condition you want to trigger.
Then build the corresponding payload and deliver it in the appropriate format to the program.</p></blockquote><p>If you&#x27;re having difficulties solving this exercise, go through <a href="/hardware-software-interface/Labs/lab11#buffer-overflow-attacks">this</a> reading material.</p><blockquote><p><strong>WARNING</strong> If you try using a payload generated with python and it doesn&#x27;t work, try simply copying its content in the terminal</p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a class="hash-link" href="#resources" title="Direct link to heading">​</a></h3><p>If you found the laboratory interesting in a positive way, you can learn more about this type of attack, as well as cybersecurity in general, on this <a href="https://www.youtube.com/c/LiveOverflow" target="_blank" rel="noopener noreferrer">channel</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-to-buffers">Introduction to Buffers<a class="hash-link" href="#introduction-to-buffers" title="Direct link to heading">​</a></h2><p>This laboratory aims to present the concept of buffers in C and assembly language along with their specific operations, as well as the vulnerabilities they pose and how they can be exploited by a potential attacker using a program to attack a system or obtain information to which they would not normally have access.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="objectives">Objectives<a class="hash-link" href="#objectives" title="Direct link to heading">​</a></h3><ul><li>Introducing the concepts of buffers and buffer overflow</li><li>Examples of buffer overflow attacks</li><li>Presentation of ways to secure programs to prevent buffer overflow attacks</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="buffer-buffer-overflow">Buffer. Buffer Overflow<a class="hash-link" href="#buffer-buffer-overflow" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-buffer">What is a Buffer?<a class="hash-link" href="#what-is-a-buffer" title="Direct link to heading">​</a></h4><p>A buffer is a memory area defined by a start address and a size.
Let N be the size of the buffer, for example, the number of elements.
The total size of the buffer is N times the size of one element.
A string is a specific case of a buffer.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-buffer-overflow">What is a Buffer Overflow?<a class="hash-link" href="#what-is-a-buffer-overflow" title="Direct link to heading">​</a></h4><p>A buffer overflow occurs when the upper limit of a buffer is exceeded during traversal, for example, the position of the last element (v<!-- -->[N - 1]<!-- -->).
A buffer overflow is a specific case of an <em>index out of bounds</em>, where the vector can be accessed using negative indices.
Many functions in C do not check the size of the buffers they work with, leading to buffer overflow errors when called.
Some examples of such functions are:</p><ul><li><a href="http://www.cplusplus.com/reference/cstring/memcpy/" target="_blank" rel="noopener noreferrer">memcpy</a></li><li><a href="https://www.cplusplus.com/reference/cstring/strcpy/" target="_blank" rel="noopener noreferrer">strcpy</a></li><li><a href="http://www.cplusplus.com/reference/cstdio/fgets/" target="_blank" rel="noopener noreferrer">fgets</a></li></ul><p>A classic example of a buffer overflow is shown in the following code:</p><div class="language-C codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-C codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">char buffer[32];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fgets(buffer, 64, stdin);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Executing this code will result in a buffer overflow, potentially leading to a <em>Segmentation Fault</em> error, although this is not guaranteed.
Everything depends on the buffer&#x27;s position in the stack and what will be overwritten by the 32 bytes that exceed the buffer&#x27;s size.
More details on what will be overwritten and how this will be done will be discovered when solving the proposed exercises.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-make-a-buffer-overflow">How to make a Buffer Overflow?<a class="hash-link" href="#how-to-make-a-buffer-overflow" title="Direct link to heading">​</a></h4><p>In the previous example we see that we can use a buffer to write more than &quot;we should&quot;.
But what exactly can we do with this?
In the following example we can use <em>fgets()</em> to overwrite <em>very_important_var</em> and enter <em>jackpot()</em> function.
All we have to do is change the value of <em>very_important_var</em> to <em>0xDEADCODE</em>, when reading the buffer.</p><div class="language-C codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-C codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">int very_important_var = 0xDEADBEEF;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">char buffer[32];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fgets(buffer, 64, stdin);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (very_important_var == 0xDEADC0DE) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jackpot();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure-preparation">Infrastructure Preparation<a class="hash-link" href="#infrastructure-preparation" title="Direct link to heading">​</a></h4><p>Throughout the laboratory, in the command-line, we will use:</p><ul><li><code>nasm</code> assembler</li><li><code>gcc</code> command as a linker</li><li><code>objdump</code> and <code>ghidra</code> for disassembling object and executable files</li><li><code>gdb</code> for dynamic analysis, investigation, and debugging</li></ul><p>This setup will allow us to perform assembly programming, linking, disassembly, and dynamic analysis using the specified tools in the command-line environment.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="buffer-overflow-attacks">Buffer Overflow Attacks<a class="hash-link" href="#buffer-overflow-attacks" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-is-buffer-overflow-used">How is Buffer Overflow Used?<a class="hash-link" href="#how-is-buffer-overflow-used" title="Direct link to heading">​</a></h3><p>Buffer overflow can be exploited by a potential attacker to overwrite certain data within a program, affecting the execution flow and providing specific benefits to the attacker.
Most often, an attacker initiates a buffer overflow attack with the goal of gaining access to confidential data that a normal user would not typically have access to.</p><p>Buffer overflow attacks are generally used on static buffers stored at the stack level.
This is because the stack, in addition to program data, also stores return addresses following function calls (see laboratory 7).
These addresses can be overwritten through a buffer overflow attack, in which case the program&#x27;s execution flow can be altered.
By overwriting the return address, upon completion of the current function&#x27;s execution, the program will not return to the calling function&#x27;s execution but will instead &quot;jump&quot; to another address within the executable where execution will continue.
This event can lead to undefined behavior of the program if the jump address has not been calculated correctly.</p><p>The goal of an attacker is to take control of a system by gaining access to a shell from which they can run commands.
This can be achieved by overwriting the return address, using a system call through which a shell can be opened on the system where the executable is running (more details in the OS course).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-we-protect-against-buffer-overflow-attacks">How Do We Protect Against Buffer Overflow Attacks?<a class="hash-link" href="#how-do-we-protect-against-buffer-overflow-attacks" title="Direct link to heading">​</a></h3><p>There are many ways to protect an executable from these types of attacks, most of which you will study in detail in the OS course next year.
A good practice against this type of attack is to avoid using insecure functions, such as those mentioned above.
More details on best practices against buffer overflow attacks can be found <a href="https://security.web.cern.ch/recommendations/en/codetools/c.shtml" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Often, best practices prove to be insufficient in the &quot;battle&quot; against hackers, which is why several executable protection mechanisms have been invented by manipulating the code and its position within the executable (<em>Position Independent Code</em> - <a href="https://en.wikipedia.org/wiki/Position-independent_code" target="_blank" rel="noopener noreferrer">PIC</a>), through address randomization (<em>Address Space Layout Randomization</em> - <a href="https://en.wikipedia.org/wiki/Address_space_layout_randomization" target="_blank" rel="noopener noreferrer">ASLR</a>), or by introducing additional checks in the code to detect potential attacks.</p><p>These checks are performed by introducing special values, called <strong>canaries</strong>, on the stack between the buffer and the function&#x27;s return address.
These values are generated and placed within the executable by the compiler and differ with each run of the executable.
When an attacker tries to overwrite the return address, they will also overwrite the canary value, and before exiting the current function call, it will be checked whether that value has been modified or not.
If it has been modified, it means that a buffer overflow has occurred, and the program execution will be interrupted.</p><p>This mechanism is called <strong>Stack Smashing Protection</strong> or <strong>Stack Guard</strong>. More details about Stack Guard and buffer overflow attacks can be found <a href="https://en.wikipedia.org/wiki/Buffer_overflow" target="_blank" rel="noopener noreferrer">here</a>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/hardware-software-interface/Labs/lab10"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Lab 10 - The C - Assembly Interaction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/hardware-software-interface/Labs/lab12"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lab 12 - Linking</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#task-buffer-in-the-data-section" class="table-of-contents__link toc-highlight">Task: Buffer in the <code>.data</code> Section</a></li><li><a href="#task-buffer-on-the-stack" class="table-of-contents__link toc-highlight">Task: Buffer on the Stack</a><ul><li><a href="#part-1" class="table-of-contents__link toc-highlight">Part 1</a></li><li><a href="#part-2" class="table-of-contents__link toc-highlight">Part 2</a></li><li><a href="#part-3" class="table-of-contents__link toc-highlight">Part 3</a></li></ul></li><li><a href="#task-reading-data-from-standard-input" class="table-of-contents__link toc-highlight">Task: Reading Data from Standard Input</a><ul><li><a href="#buffer-overflow-with-data-from-standard-input" class="table-of-contents__link toc-highlight">Buffer Overflow with Data from Standard Input</a></li></ul></li><li><a href="#task-buffer-overflow-with-data-from-standard-input-and-fgets" class="table-of-contents__link toc-highlight">Task: Buffer Overflow with Data from Standard Input and <code>fgets()</code></a></li><li><a href="#task-buffer-overflow-for-program-written-in-c" class="table-of-contents__link toc-highlight">Task: Buffer Overflow for Program Written in C</a><ul><li><a href="#overwrite-variable-using-a-buffer" class="table-of-contents__link toc-highlight">Overwrite Variable Using a Buffer</a></li><li><a href="#bonus-stack-canary" class="table-of-contents__link toc-highlight">BONUS: Stack Canary</a></li></ul></li><li><a href="#task-overwrite-return-address" class="table-of-contents__link toc-highlight">Task: Overwrite Return Address</a></li><li><a href="#task-buffer-overflow-for-binary" class="table-of-contents__link toc-highlight">Task: Buffer Overflow for Binary</a><ul><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li></ul></li><li><a href="#introduction-to-buffers" class="table-of-contents__link toc-highlight">Introduction to Buffers</a><ul><li><a href="#objectives" class="table-of-contents__link toc-highlight">Objectives</a></li><li><a href="#buffer-buffer-overflow" class="table-of-contents__link toc-highlight">Buffer. Buffer Overflow</a></li></ul></li><li><a href="#buffer-overflow-attacks" class="table-of-contents__link toc-highlight">Buffer Overflow Attacks</a><ul><li><a href="#how-is-buffer-overflow-used" class="table-of-contents__link toc-highlight">How is Buffer Overflow Used?</a></li><li><a href="#how-do-we-protect-against-buffer-overflow-attacks" class="table-of-contents__link toc-highlight">How Do We Protect Against Buffer Overflow Attacks?</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://curs.upb.ro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ocw.cs.pub.ro/courses/pclp2" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/10c1a" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 OpenEdu Team</div></div></div></footer></div>
<script src="/hardware-software-interface/assets/js/runtime~main.dfa37bb3.js"></script>
<script src="/hardware-software-interface/assets/js/main.5804b916.js"></script>
</body>
</html>